<?xml version="1.0" encoding="UTF-8"?>
<project name="jcseg" default="usage" basedir=".">
    <!--Initialize-->
    <target name="init">
		<echo message="------------------------------------------------------------"/>
		<echo message="----------BUILDING JCSEG PACKAGE----------------------------"/>
		<echo message=""/>
		<property name="bottom" value="jcseg 2012-2013"/>
		<property name="jars" value="${basedir}"/>
		<property name="sources" value="${basedir}/src"/>
		<property name="classes" value="${basedir}/classes"/>
		<property name="version" value="1.9.2"/>
		<property name="lib.dir" value="${basedir}/lib"/>
		<property name="api" value="${basedir}/doc"/>

		<delete dir="${classes}"/>
		<delete dir="${api}"/>
		<delete>
			<fileset dir="${basedir}" includes="*.jar"/>
		</delete>		

		<mkdir dir="${classes}"/>
		<copy file="jcseg.properties" todir="${classes}"/>
		<mkdir dir="${api}"/>
    </target>

    <path id="classpath">
		<fileset dir="${lib.dir}" includes="**/*.jar"/>
    </path>

    <!--Build-->
    <target name="build" depends="init">
		<echo message="-------------Compiling Application--------------"/>
		<echo message="${lib.dir}"/>
		<javac srcdir="${sources}" destdir="${classes}">
			<classpath>
				<path id="classpath">
					<fileset dir="${lib.dir}" includes="**/*.jar"/>
				</path>
			</classpath>
		</javac>
    </target>

    <!--Archive-->
    <target name="dist" depends="build">
		<jar jarfile="${jars}/jcseg-core-${version}.jar" basedir="${classes}" includes="**/*" excludes="org/lionsoul/jcseg/solr/*,org/lionsoul/jcseg/lucene/*">
			<!--manifest information setting-->
			<manifest>
				<attribute name="Main-Class" value="org.lionsoul.jcseg.test.JcsegTest"/>
				<attribute name="Class-Path" value=""/>
			</manifest>
		</jar>
		<jar jarfile="${jars}/jcseg-analyzer-${version}.jar" basedir="${classes}" includes="org/lionsoul/jcseg/lucene/*"/>
		<jar jarfile="${jars}/jcseg-solr-${version}.jar" basedir="${classes}" includes="org/lionsoul/jcseg/solr/*"/>
		
    	<!--jcseg dictionary converter tools-->
		<jar jarfile="${jars}/tools/jcseg-dicst.jar" basedir="${classes}" includes="org/lionsoul/jcseg/util/dic/*,org/lionsoul/jcseg/util/IStringBuffer.class">
			<manifest>
				<attribute name="Main-Class" value="org.lionsoul.jcseg.util.dic.DicConverter"/>
				<attribute name="Class-Path" value=""/>
			</manifest>
		</jar>
		
    	<!--jcseg dictionary merge tools-->
		<jar jarfile="${jars}/tools/jcseg-dicmerge.jar" basedir="${classes}" includes="org/lionsoul/jcseg/Word.class,org/lionsoul/jcseg/core/IWord.class,org/lionsoul/jcseg/util/IStringBuffer.class,org/lionsoul/jcseg/util/Sort.class,org/lionsoul/jcseg/util/dic/*">
			<manifest>
				<attribute name="Main-Class" value="org.lionsoul.jcseg.util.dic.DicMerge"/>
				<attribute name="Class-Path" value=""/>
			</manifest>
		</jar>

    </target>

    <!--Java document-->
    <target name="all" depends="dist">
		<echo message="------------Making Java Document------------------"/>
		<javadoc packagenames="org.*"
			sourcepath="${sources}"
			destdir="${api}"
			bottom="${bottom}"
			charset="UTF-8"
			author="false">
			<classpath>
			<pathelement location="${classes}"/>
			</classpath>
		</javadoc>
		<jar jarfile="${jars}/jcseg-${version}-javadoc.jar" basedir="${api}" includes="**/*"></jar>
    </target>

    <target name="usage">
		<echo message="*** jcseg ANT Build Script ***"/>
		<echo message="Usage: "/>
		<echo message="   ant [target]"/>
		<echo message=""/>     
		<echo message="   target : "/>
		<echo message="            build : Build Application"/>     
		<echo message="            dist  : Build Application + Archive (JAR)"/>     
		<echo message="            all   : Build Application + Archive + JavaDoc"/>       
    </target>

</project>
